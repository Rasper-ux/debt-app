<!DOCTYPE html>
<html lang="fi">
  <head>
    <title>Debt App</title>
  </head>

  <body>
    <h1>Welcome to the Debt App</h1>
    <p>This is the home page.</p>
    <p>Username: {{ user.username }}</p>

    {% if balance < 0 %}
    <p style="color: red">You owe: {{ abs_balance }}</p>
    {% elif balance > 0 %}
    <p style="color: green">You are owed: {{ balance }}</p>
    {% else %}
    <p>Your balance is settled.</p>
    {% endif %} {% if error %}
    <p style="color: red">{{ error }}</p>
    {% endif %}

    <h2>Debts You Owe</h2>
    <ul>
      {% for debt in debts_owed %}
      <li>
        Owe {{ debt.amount }} to {{ debt.creditor.username }}:
        {{debt.description}}
        <form
          action="{% url 'delete_debt' debt.id %}"
          method="POST"
          style="display: inline"
        >
          {% csrf_token %}
          <button type="submit">Settle Debt</button>
        </form>
      </li>
      {% empty %}
      <li>No debts owed.</li>
      {% endfor %}
    </ul>

    <h2>Debts You Lent</h2>
    <ul>
      {% for debt in debts_lent %}
      <li>
        Lent {{ debt.amount }} to {{ debt.debtor.username }}
        {{debt.description}}
        <form
          action="{% url 'delete_debt' debt.id %}"
          method="POST"
          style="display: inline"
        >
          {% csrf_token %}
          <button type="submit">Settle Debt</button>
        </form>
      </li>
      {% empty %}
      <li>No debts lent.</li>
      {% endfor %}
    </ul>

    <h2>Add New Debt</h2>
    <form action="{% url 'add_debt' %}" method="POST">
      {% csrf_token %}
      <label>Role:</label>
      <select name="role" required>
        <option value="creditor">I am the creditor</option>
        <option value="debtor">I am the debtor</option>
      </select>
      <br />
      <label>User:</label>
      <select name="target" required>
        {% for u in users %}
        <option value="{{ u.id }}">{{ u.username }}</option>
        {% endfor %}
      </select>
      <br />
      <label>Amount (â‚¬):</label>
      <input type="number" step="0.5" name="amount" required />
      <br />
      <label>Description:</label>
      <input type="text" name="description" maxlength="100" />
      <br />
      <button type="submit">Add Debt</button>
    </form>

    <form action="{% url 'logout' %}" method="POST">
      {% csrf_token %}
      <input type="submit" value="Logout" />
    </form>
  </body>
</html>
